(function(t){function e(e){for(var a,i,c=e[0],o=e[1],l=e[2],h=0,d=[];h<c.length;h++)i=c[h],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,c=1;c<s.length;c++){var o=s[c];0!==n[o]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},n={app:0},r=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0b92":function(t,e,s){"use strict";var a=s("622a"),n=s.n(a);n.a},"29cc":function(t,e,s){},"2c06":function(t,e,s){"use strict";var a=s("29cc"),n=s.n(a);n.a},3715:function(t,e,s){"use strict";var a=s("c792"),n=s.n(a);n.a},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},r=[],i={name:"App"},c=i,o=s("2877"),l=Object(o["a"])(c,n,r,!1,null,null,null),u=l.exports,h=s("8c4f"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"guess"},[s("mx-canvas",{ref:"canvas"}),s("div",{staticClass:"game-time"},[t._v(t._s(t.gameTime))]),t.tipObj?s("div",{staticClass:"tip"},[t._v("\n    第"),s("span",{staticClass:"tip__important"},[t._v(t._s(t.tipObj.index))]),t._v("个提示："),s("span",{staticClass:"tip__important"},[t._v(t._s(t.tipObj.tip))])]):t._e(),t.timeoutObj?s("div",{staticClass:"tip"},[t._v("\n    无人猜对，正确答案是"),s("span",{staticClass:"tip__important"},[t._v(t._s(t.timeoutObj.topic))])]):t._e(),s("div",{staticClass:"chat-box"},[s("div",{staticClass:"chat-wrap"},t._l(t.msgs,(function(e,a){return s("div",{key:"chat_"+a,staticClass:"chat",class:{bingo:e.bingo}},[e.bingo?[s("span",{staticClass:"chat__name"},[t._v(t._s(e.username))]),t._v(" 猜对了，答案是\n          "),s("span",{staticClass:"chat__msg"},[t._v(t._s(e.message))]),t._v("，本轮游戏结束\n        ")]:[s("span",{staticClass:"chat__name"},[t._v(t._s(e.username))]),t._v("：\n          "),s("span",{staticClass:"chat__msg"},[t._v(t._s(e.message))])]],2)})),0),s("div",{staticClass:"chat-box__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"input",attrs:{type:"text",placeholder:"输入答案，回车发送"},domProps:{value:t.message},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}}),s("button",{staticClass:"send-msg-btn",on:{click:t.sendMsg}},[t._v("发送")])])])],1)},m=[],f=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),p=(s("4917"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("canvas",{staticClass:"my-canvas",attrs:{width:"800",height:"600"}})}),v=[],g=(s("6c7b"),{name:"MxCanvas",data:function(){return{ctx:null}},methods:{startDraw:function(t){this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.color,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.lineWidth/2,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y)},drawing:function(t){this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.color,this.ctx.lineWidth=t.lineWidth,this.ctx.lineTo(t.x,t.y),this.ctx.stroke(),this.ctx.closePath(),this.ctx.arc(t.x,t.y,t.lineWidth/2,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y)},endDraw:function(){this.ctx.closePath()},clear:function(){this.ctx.clearRect(0,0,this.$el.width,this.$el.height)}},mounted:function(){var t=this.$el;this.ctx=t.getContext("2d")}}),b=g,_=(s("3715"),Object(o["a"])(b,p,v,!1,null,null,null)),w=_.exports,C=s("bc3a"),y=s.n(C),x=y.a.create({withCredentials:!0}),O=x;function k(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function j(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?k(s,!0).forEach((function(e){Object(f["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):k(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var B={name:"Guess",components:{MxCanvas:w},data:function(){return{ws:null,msgs:[],message:"",tipObj:null,gameTime:60,timeoutObj:null}},created:function(){var t=this;this.ws=new WebSocket("ws://172.16.10.108:8090"),this.ws.onmessage=function(e){var s=null,a=null,n=document.getElementsByClassName("chat-wrap")[0];switch(!0){case Boolean(e.data.match(/^startdraw:/)):s=JSON.parse(e.data.slice(10)),t.$refs.canvas.startDraw(s);break;case Boolean(e.data.match(/^drawing:/)):s=JSON.parse(e.data.slice(8)),t.$refs.canvas.drawing(s);break;case Boolean(e.data.match(/^enddraw/)):t.$refs.canvas.endDraw();break;case Boolean(e.data.match(/^msg:/)):a=JSON.parse(e.data.slice(4)),t.msgs.push(a),t.msgs.length>200&&t.msgs.shift(),n.scrollTop=n.scrollHeight;break;case Boolean(e.data.match(/^bingo:/)):a=JSON.parse(e.data.slice(6)),t.msgs.push(j({},a,{bingo:!0})),t.msgs.length>200&&t.msgs.shift(),n.scrollTop=n.scrollHeight;break;case Boolean(e.data.match(/^tip:/)):t.tipObj=JSON.parse(e.data.slice(4));break;case Boolean(e.data.match(/^timedown:/)):t.gameTime=e.data.slice(9);break;case Boolean(e.data.match(/^startgame:/)):t.$refs.canvas.clear(),t.timeoutObj=null,t.tipObj=null;break;case Boolean(e.data.match(/^timeout:/)):t.tipObj=null,t.timeoutObj=JSON.parse(e.data.slice(8));break}}},methods:{sendMsg:function(){var t=this;this.message&&O.post("/api/message",{message:this.message}).then((function(e){200===e.status&&(t.message="")}))}}},S=B,P=(s("b1cc"),Object(o["a"])(S,d,m,!1,null,"2f5a0a38",null)),$=P.exports,M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"draw"},[s("mx-canvas",{ref:"canvas",nativeOn:{mousedown:function(e){return t.startDraw(e)},mousemove:function(e){return t.drawing(e)},mouseup:function(e){return t.endDraw(e)}}}),s("div",{staticClass:"chat-box"},[s("div",{staticClass:"chat-wrap"},t._l(t.msgs,(function(e,a){return s("div",{key:"chat_"+a,staticClass:"chat",class:{bingo:e.bingo}},[s("span",{staticClass:"chat__name"},[t._v(t._s(e.username))]),t._v("：\n        "),s("span",{staticClass:"chat__msg"},[t._v(t._s(e.message))])])})),0)]),s("div",{staticClass:"topic"},[t._v(t._s(t.topic))]),s("div",{staticClass:"game-time"},[t._v(t._s(t.gameTime))]),s("div",{staticClass:"controller-bar"},[s("div",{staticClass:"brush-wrap"},t._l(t.brushWidthList,(function(e,a){return s("div",{key:"brush_width_"+a,staticClass:"brush",style:{borderColor:t.currentBrushColor,backgroundColor:t.currentBrushWidth===e?t.currentBrushColor:"#fff"},on:{click:function(s){t.currentBrushWidth=e}}},[s("span",{staticClass:"brush__point",style:{width:e+"px",height:e+"px",backgroundColor:t.currentBrushWidth===e?"#fff":t.currentBrushColor}})])})),0),s("button",{on:{click:t.clear}},[t._v("清空")]),s("div",{staticClass:"brush-color-wrap"},t._l(t.brushColorList,(function(e,a){return s("div",{key:"brush_color_"+a,staticClass:"brush-color",class:{"brush-color--active":e===t.currentBrushColor},style:{backgroundColor:e},on:{click:function(s){t.currentBrushColor=e}}})})),0)])],1)},W=[],D={name:"Draw",components:{MxCanvas:w},data:function(){return{msgs:[],isMousedown:!1,ws:null,brushWidthList:[3,7,10,13,20],brushColorList:["#000000","#ff0000","#ffa500","#ffff00","#008000","#0000ff","#4b0082","#ee82ee"],currentBrushWidth:3,currentBrushColor:"#000000",topic:"",gameTime:60}},created:function(){var t=this;this.ws=new WebSocket("ws://172.16.10.108:8090");var e=document.getElementsByClassName("chat-wrap")[0];this.ws.onmessage=function(s){if(s.data.match(/^startgame:/))t.$refs.canvas.clear(),O.get("/api/topic").then((function(e){t.topic=e.data}));else if(s.data.match(/^timedown:/))t.gameTime=s.data.slice(9);else if(s.data.match(/^bingo:/)){var a=JSON.parse(s.data.slice(6));alert(a.username+"猜对了")}else s.data.match(/^msg:/)&&(t.msgs.push(JSON.parse(s.data.slice(4))),t.msgs.length>200&&t.msgs.shift(),e.scrollTop=e.scrollHeight)},O.get("/api/username").then((function(e){t.username=e.data}))},methods:{clear:function(){this.$refs.canvas.clear()},startDraw:function(t){if(0===t.button){var e={x:t.offsetX,y:t.offsetY,lineWidth:this.currentBrushWidth,color:this.currentBrushColor};this.isMousedown=!0,this.$refs.canvas.startDraw(e),this.ws.send("startdraw:"+JSON.stringify(e))}},drawing:function(t){if(this.isMousedown){var e={x:t.offsetX,y:t.offsetY,lineWidth:this.currentBrushWidth,color:this.currentBrushColor};this.$refs.canvas.drawing(e),this.ws.send("drawing:"+JSON.stringify(e))}},endDraw:function(){this.isMousedown=!1,this.$refs.canvas.endDraw(),this.ws.send("enddraw")}}},N=D,T=(s("2c06"),Object(o["a"])(N,M,W,!1,null,"5d536255",null)),E=T.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login"},[s("div",{staticClass:"project-name"},[t._v("你画我猜")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"username-input",attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),s("button",{staticClass:"confirm-btn",on:{click:t.login}},[t._v("确认")])])},L=[],I={name:"Login",data:function(){return{username:""}},methods:{login:function(){var t=this;O.post("/api/login",{username:this.username}).then((function(e){e.data.success&&t.$router.push("/")}))}}},V=I,G=(s("c4fa"),Object(o["a"])(V,J,L,!1,null,"6531a5ea",null)),H=G.exports,R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"random"},[s("div",{staticClass:"name",class:{"name--ensure":t.ensure}},[t._v(t._s(t.username))]),s("div",[s("button",{on:{click:t.startSelect}},[t._v("选择")]),s("button",{on:{click:t.startGame}},[t._v("开始")]),s("button",{on:{click:t.viewBoard}},[t._v("查看排行")])]),s("table",{directives:[{name:"show",rawName:"v-show",value:t.boardVisible,expression:"boardVisible"}],staticClass:"board"},[t._m(0),s("tbody",t._l(t.score,(function(e,a){return s("tr",{key:"score-item-"+a},[s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(e.score))])])})),0)])])},X=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("th",[s("td",[t._v("username")]),s("td",[t._v("score")])])])}],Y={name:"Random",data:function(){return{username:"",ensure:!1,boardVisible:!1,score:[]}},methods:{viewBoard:function(){var t=this;O.get("/api/score").then((function(e){t.score=e.data,t.boardVisible=!0}))},startSelect:function(){var t=this;O.get("/api/usernames").then((function(e){var s=e.data,a=20;s.length<1&&alert("人数太少"),t.ensure=!1;var n=setInterval((function(){0!==a?(t.username=s[Math.floor(Math.random()*s.length)],a--):(t.username=s[Math.floor(Math.random()*s.length)],t.ensure=!0,clearInterval(n),O.post("/api/random-user",{username:t.username}))}),100)}))},startGame:function(){O.post("/api/start-game",{username:this.username})}}},A=Y,q=(s("0b92"),Object(o["a"])(A,R,X,!1,null,"8f783bde",null)),z=q.exports,F=[{path:"/draw",component:E},{path:"/login",component:H},{path:"/random",component:z},{path:"/",component:$}],K=F;a["a"].use(h["a"]),a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(u)},router:new h["a"]({routes:K})}).$mount("#app")},"622a":function(t,e,s){},b1cc:function(t,e,s){"use strict";var a=s("ea52"),n=s.n(a);n.a},c4fa:function(t,e,s){"use strict";var a=s("f668"),n=s.n(a);n.a},c792:function(t,e,s){},ea52:function(t,e,s){},f668:function(t,e,s){}});
//# sourceMappingURL=app.05754117.js.map